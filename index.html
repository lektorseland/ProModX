<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Programmering og Modellering X">

<title>Programmering og Modellering X</title>

<!-- Bootstrap style: bootstrap -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}

/*
in.collapse+a.btn.showdetails:before { content:'Hide details'; }
.collapse+a.btn.showdetails:before { content:'Show details'; }
*/
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Table of contents',
               0,
               'table_of_contents',
               'table_of_contents'),
              ('Kapittel 3: Numeriske metoder intro', 0, None, '___sec0'),
              ('Differensiallikninger: Matematisk teori', 1, None, '___sec1'),
              ('Eulers metode', 1, None, '___sec2'),
              ('Første ordens differensiallikninger', 2, None, '___sec3'),
              ('Andre ordens differensiallikninger', 2, None, '___sec4'),
              ('Differensiallikninger: Numerisk i python', 1, None, '___sec5'),
              ('Eulers metode', 2, None, '___sec6'),
              ('Program for løsning av første ordens differensiallikning med '
               'Eulers metode',
               3,
               None,
               '___sec7'),
              ('Program for løsning av andre ordens differensiallikning med '
               'Eulers metode',
               3,
               None,
               '___sec8'),
              ('Problemer med Eulers metode', 2, None, '___sec9'),
              ('Euler-Cromer metoden', 2, None, '___sec10'),
              ('Oppgaver', 1, None, '___sec11'),
              ('Exercise 1: Flervalgsquiz', 2, None, '___sec12'),
              ('Exercise 2: Forståelse av Eulers metode', 2, None, '___sec13'),
              ('Exercise 3: Første ordens differensiallikninger',
               2,
               None,
               '___sec14'),
              ('Exercise 4: Andre ordens differensiallikninger',
               2,
               None,
               '___sec15'),
              ('Exercise 5: Vi omgjør metodene til funksjoner',
               2,
               None,
               '___sec16'),
              ('Exercise 6: 2. ordens Runge Kutta metode (Utfordring)',
               2,
               None,
               '___sec17')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="main_ch4.html">Programmering og Modellering X</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#table_of_contents" style="font-size: 80%;">Table of contents</a></li>
     <!-- navigation toc: --> <li><a href="#___sec0" style="font-size: 80%;">Kapittel 3: Numeriske metoder intro</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<!-- ------------------- main content ---------------------- -->

<!-- doconce format html main_ch4.do.txt --html_style=bootstrap --html_links_in_new_window --section_numbering=off --toc_depth=1 -->


<div class="jumbotron">
<center><h1>Programmering og Modellering X</h1></center>  <!-- document title -->

<p>
<!-- author(s): Aleksander Seland -->

<center>
<b>Aleksander Seland</b> 
</center>

<p>
<!-- institution(s) -->

<br>
<p>
<center><h4>Mar 16, 2019</h4></center> <!-- date -->
<br>
<center>
<img src="https://www.ntbinfo.no/data/images/00262/9a718cca-1f1f-4eba-b745-02b3157c0282-w_300_h_100.png" height="100">
<br />
<br />
<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License</a>
</center>

<p>
</div> <!-- end jumbotron -->

<h1 id="table_of_contents">Table of contents</h2>

<p>
<a href="#___sec0"> Kapittel 3: Numeriske metoder intro </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec1"> Differensiallikninger: Matematisk teori </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec2"> Eulers metode </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec5"> Differensiallikninger: Numerisk i python </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec11"> Oppgaver </a><br>
</p>
<p>

<center><h1 id="___sec0" class="anchor">Kapittel 3: Numeriske metoder intro </h1></center> <!-- chapter heading -->

<h1 id="___sec1" class="anchor">Differensiallikninger: Matematisk teori </h1>
Differensiallikninger er spesielle og sv&#230;rt viktige likninger i all moderne matematikk og realfag. Faktisk er det slik at avanserte differensiallikninger ligger i bunn av alt arbeidet forskere, ingeni&#248;rer og andre driver med fra dag til dag. Det spesielle med disse likningene er at l&#248;sningen er ikke p&#229; formen \( x=\ldots \), \( t = \ldots \) eller \( y = \ldots \), svaret er istedet en hel funksjon \( f(x)=\ldots \). Ligningene kan v&#230;re skrevet p&#229; mange forskjellige m&#229;ter fra situasjon til situasjon, men rent matematisk, og p&#229; dette niv&#229;et, kan vi si at en differensiallikning er en likning som best&#229;r av \( y'',y',y,x \) og tall. La oss v&#230;re litt mer formelle.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Definisjon differensiallikninger.</b>
En differensiallikning er p&#229; formen:
\[
a(x)\cdot y' + b(x)\cdot y = c(x)
\]
kalles en <em>f&#248;rste ordens</em> differensiallikning og en differensiallikning p&#229; formen:
\[
a(x)\cdot y'' + b(x)\cdot y' + c(x)\cdot y = d(x)
\]
kalles en <em>andre ordens</em> differensiallikning. <linebreak><br />
hvor \( a(x),b(x),c(x),d(x) \) er alle funksjonsuttrykk som kun inneholder tall eller \( x \)-er (eller bare en av delene). Videre er \( y \) den ukjente funksjonen, \( y' \) er den deriverte av \( y \) og \( y'' \) er den dobbelderiverte av "y".
</div>


<p>
La oss se et eksempel p&#229; en differensiallikning:
\[
3\cdot y''+2x\cdot y'+4x^{2}\cdot y = x^{2}+3x
\]
Her er \( a(x)=3 \), \( b(x) = 2x \), \( c(x) = 4x^{2} \) og \( d(x) = x^{2}+3x \). <linebreak><br />
De s&#229;kalte "analytiske" l&#248;sningene av differensiallikningene skal vi ikke g&#229; inn p&#229; her, det vi derimot skal se p&#229; er hvordan vi kan finne l&#248;sningen ved &#229; regne ut punktene i l&#248;sningsgrafen etter hverandre.

<h1 id="___sec2" class="anchor">Eulers metode </h1>

<h2 id="___sec3" class="anchor">F&#248;rste ordens differensiallikninger </h2>
En av de f&#248;rste m&#229;tene man l&#230;rte om funksjoner i grunnskolen, var gjennom verditabeller. La oss se p&#229; en verditabell for funksjonen \( f(x)=x^{2} \).

<p>

<div class="row">
  <div class="col-xs-2">
    <table class="table table-striped table-hover table-condensed">
<tr></tr>
<tbody>
<tr><td align="center">   \( x \)       </td> <td align="center">   -2    </td> <td align="center">   -1    </td> <td align="center">   0    </td> <td align="center">   1    </td> <td align="center">   2    </td> </tr>
<tr><td align="center">   \( f(x) \)    </td> <td align="center">   4     </td> <td align="center">   1     </td> <td align="center">   0    </td> <td align="center">   1    </td> <td align="center">   4    </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-2 -->
</div> <!-- cell row -->
<p>
Vi kan tenke p&#229; denne verditabellen som to arrays: <br />
<code>x = [-2,-1,0,1,2]</code> og <code>y = [4,1,0,1,4]</code> hvor vi har skrevet \( y \) istedet for \( f(x) \). N&#229;r det kommer til differensiallikninger er situasjonen ganske annerledes. Informasjonen vi f&#229;r kan brytes ned slik:

<ul>
<li> Vi f&#229;r et initialpunkt, f.eks \( f(1) = 3 \).</li>
<li> Vi f&#229;r en likning, f.eks \( y' = 3y \)</li>
</ul>

Dette er det samme som &#229; si at vi vet grafen g&#229;r gjennom punktet \( (1,3) \) og at den deriverte til funksjonen (husk at \( y = f(x) \)) er 3 ganger s&#229; stor som den uderiverte funksjonen. En annen m&#229;te &#229; illustrere samme situasjon er:

<div class="row">
  <div class="col-xs-2">
    <table class="table table-striped table-hover table-condensed">
<tr></tr>
<tbody>
<tr><td align="center">   \( x \)       </td> <td align="center">   1    </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ...    </td> </tr>
<tr><td align="center">   \( f(x) \)    </td> <td align="center">   3    </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ...    </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-2 -->
</div> <!-- cell row -->
med \( y'=3y \) eller \( f'(x) = 3\cdot f(x) \).  <br />
<br />
S&#229; hvordan kan vi l&#248;se denne situasjonen? Vel, vi trenger en array med \( x \) verdier, og en array med \( y \)-verdier for &#229; tegne grafen. Vi starter med &#229; introdusere en <em>steglengde</em> \( h \). Denne blir brukt akkurat p&#229; samme m&#229;te som i integrasjon og derivasjon, alts&#229; som en avstand mellom \( x \)-verdiene. La oss n&#229; kalle den f&#248;rste \( x \)-verdien for \( x_{0} \), da vil \( x_{1}=x_{0} + h \). Dersom vi skal skrive dette generelt betyr det at
\[
x_{i+1} = x_{i}+h
\]
alts&#229; at vi lander p&#229; den neste \( x \)-verdien ved &#229; ta den n&#229;v&#230;rende og legge til \( h \). <br />
<br />
Den neste \( y \)-verdien, \( y_{i+1} \) er gitt av \( f(x_{i+1}) \). Fra over har vi at \( x_{i+1} = x_{i}+h \), som betyr at at \( f(x_{i+1})=f(x_{i}+h) \). Problemet n&#229; er at vi trenger en formel for dette uttrykket. For &#229; kunne lage dette m&#229; vi ta utgangspunkt i formelen for den deriverte slik vi bruker den i programmering. Eneste forskjellen jeg gj&#248;r er &#229; skrive \( x_{i} \) i stedet for \( x \). Da f&#229;r vi:
\[
f'(x_{i})\approx\frac{f(x_{i}+h)-f(x_{i})}{h}
\]
V&#229;rt m&#229;l er n&#229; &#229; f&#229; \( f(x_{i}+h) \) alene i denne formelen. Utregningen blir slik:
$$
\begin{align*}
f'(x_{i}) & \approx\frac{f(x_{i}+h)-f(x_{i})}{h}\quad|\cdot h\\
f'(x_{i})\cdot h & \approx f(x_{i}+h)-f(x_{i})\\
f(x_{i})+f'(x_{i})\cdot h & \approx f(x_{i}+h)\\
f(x_{i}+h) & \approx f(x_{i})+f'(x_{i})\cdot h
\end{align*}
$$

Vi tar s&#229; &#229; omskriver denne formelen over til \( y \) istedet for funksjonene.
\[
y_{i+1}\approx y_{i}+y{'}_{i}\cdot h
\]
Da har vi mulighet til &#229; regne ut situasjonen vi startet med. I formelen for \( y_{i+1} \) ser vi at vi har \( y'_{i} \), denne regnes ut fra differensiallikningen \( y'=3y \). La oss gj&#248;re noen utregninger med denne differensiallikningen og \( x_{0}=1 \), \( y_{0} = 3 \) og \( h \) = 1:
$$
\begin{align*}
x_{1} & =x_{0}+h=1+1=2\\
y_{1} & =y_{0}+y'_{0}\cdot h\\
 & =y_{0}+3y_{0}\cdot h\\
 & =3+3\cdot3\cdot1\\
 & =12\\
\\
x_{2} & =x_{1}+h=2+1=3\\
y_{2} & =y_{1}+y'_{1}\cdot h\\
 & =y_{1}+3y{}_{1}\cdot h\\
 & =12+3\cdot12\cdot1\\
 & =48
\end{align*}
$$

Tabellen vi s&#229; p&#229; tidligere ser n&#229; slik ut:

<div class="row">
  <div class="col-xs-2">
    <table class="table table-striped table-hover table-condensed">
<tr></tr>
<tbody>
<tr><td align="center">   \( x \)       </td> <td align="center">   1    </td> <td align="center">   2     </td> <td align="center">   3     </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ...    </td> </tr>
<tr><td align="center">   \( f(x) \)    </td> <td align="center">   3    </td> <td align="center">   12    </td> <td align="center">   48    </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ...    </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-2 -->
</div> <!-- cell row -->
Vi kan selvsagt fortsette dette s&#229; lenge vi vil og stadig regne ut nye punkter p&#229; l&#248;sningsgrafen. La oss n&#229; oppsummere.
<div class="alert alert-block alert-success alert-text-normal"><b>Eulers metode for f&#248;rste ordens differensiallikninger.</b>
Gitt en f&#248;rste ordens differensiallikning, &#233;n initialbetingelse \( (x_{0},y_{0}) \), og en avstand/steglengde mellom \( x \)-verdiene \( h \), kan vi regne ut punktene p&#229; grafen ved
$$
\begin{align*}
y_{i+1} & =y_{i}+y{'}_{i}\cdot h\\
x_{i+1} & =x_{i}+h
\end{align*}
$$
</div>


<h2 id="___sec4" class="anchor">Andre ordens differensiallikninger </h2>
Vi s&#229; nettopp hvordan vi kan finne l&#248;sningsgrafen til en differensiallikning med \( y \) derivert kun en gang. Dvs, en f&#248;rste ordens differensiallikning er en likning hvor \( y \) deriveres kun &#233;n gang. I andre ordens differensiallikninger har vi den dobbelderiverte av \( y \) i tillegg til den vanlige deriverte av \( y \). Et eksempel kan v&#230;re
\[
3y''+3xy'+5x^{2}y=2
\]
Hvordan vi l&#248;ser disse i programmering ser vi p&#229; senere. Poenget her &#229; vise hvordan Eulers metode anvendes i dette tilfellet. Det f&#248;rste vi starter med &#229; se p&#229; er hva den dobbeltderiverte faktisk er.
<br />
<br />
Den dobbelderiverte er som navnet tilsier, den deriverte av den deriverte. Symbolet er \( y'' \) eller \( f''(x) \). Tidligere i kurset s&#229; vi p&#229; definisjonen av den deriverte som
\[
f'(x)=\lim_{\Delta x \rightarrow 0}\frac{f(x+\Delta x)-f(x)}{\Delta x}
\]
For den dobbeltderiverte vil da formelen se slik ut:
\[
f''(x)=\lim_{\Delta x \rightarrow 0}\frac{f'(x+\Delta x)-f'(x)}{\Delta x}
\]
Alt dette pr&#248;ver &#229; vise deg er at dersom du finner stigningen til \( f'(x) \), s&#229; lander du p&#229; den dobbelderiverte. N&#229;r vi da har en differensiallikning som inneholder den dobbelderiverte er konsekvensen at Eulers metode f&#229;r en ekstra linje og at vi trenger to initialbetingelser \( (x_{0},y_{0}) \), \( (x_{0},y'_{0}) \). La oss skrive opp metoden:
<div class="alert alert-block alert-success alert-text-normal"><b>Eulers metode for andre ordens differensiallikninger.</b>
Eulers metode for andre ordens differensiallikninger er gitt ved
$$
\begin{align*}
y_{i+1} & =y_{i}+y{'}_{i}\cdot h\\
y{'}_{i+1} & =y{'}_{i}+y{''}_{i}\cdot h\\
x_{i+1} & =x_{i}+h
\end{align*}
$$

og to initialverdier: \( (x_{0},y_{0}) \), \( (x_{0},y'_{0}) \)
</div>

Dette er det samme som &#229; utf&#248;re Eulers metode 2 ganger etter hverandre. I f&#248;rste runde bruker vi den dobbelderiverte til &#229; regne ut den neste deriverte verdien, i andre runde bruker vi den deriverte til &#229; regne ut neste \( y \)-verdi. La oss se hvordan dette ser ut n&#229;r vi gj&#248;r det for h&#229;nd med differensiallikningen
\[
y'' = 3xy' - 2y,\quad y'{_0} = 0.5,\,y_0 = 2,\,x_{0}=0
\]
med \( h \) = 1 som tidligere. Da f&#229;r vi:
$$
\begin{align*}
x_{0} & =0\\
y'_{0} & =0.5\\
y_{0} & =2\\
\\
y''_{0} & =3x_{0}y'_{0}-2y_{0}\\
 & =3\cdot0\cdot0.5-2\cdot2=-4\\
y'_{1} & =y'_{0}+y''_{0}\cdot h=0.5+(-4)\cdot1=-3.5\\
y_{1} & =y_{0}+y'_{0}\cdot h=2+0.5\cdot1=2.5\\
x_{1} & =x_{0}+h=0+1=1\\
\\
y''_{1} & =3x_{1}y'_{1}-2y_{1}\\
 & =3\cdot1\cdot(-3.5)-2\cdot2.5=-15.5\\
y'_{2} & =y'_{1}+y''_{1}\cdot h=-3.5+(-15.5)\cdot1=-19\\
y_{2} & =y_{1}+y'_{1}\cdot h=2.5+(-3.5)\cdot1=-1\\
x_{2} & =x_{1}+h=1+1=2
\end{align*}
$$

Det vi har regnet ut n&#229; er f&#248;lgende:
Tabellen vi s&#229; p&#229; tidligere ser i dette tilfellet slik ut:

<div class="row">
  <div class="col-xs-3">
    <table class="table table-striped table-hover table-condensed">
<tr></tr>
<tbody>
<tr><td align="center">   \( x \)         </td> <td align="center">   0      </td> <td align="center">   1        </td> <td align="center">   2      </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ...    </td> </tr>
<tr><td align="center">   \( f''(x) \)    </td> <td align="center">   -4     </td> <td align="center">   -15.5    </td> <td align="center">   ?      </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ...    </td> </tr>
<tr><td align="center">   \( f'(x) \)     </td> <td align="center">   0.5    </td> <td align="center">   -3.5     </td> <td align="center">   -19    </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ...    </td> </tr>
<tr><td align="center">   \( f(x) \)      </td> <td align="center">   2      </td> <td align="center">   2.5      </td> <td align="center">   -1     </td> <td align="center">   ?    </td> <td align="center">   ?    </td> <td align="center">   ...    </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-3 -->
</div> <!-- cell row -->
Vi kunne fortsatt s&#229; lenge vi ville, men som dere ser er dette sv&#230;rt tungvint &#229; gj&#248;re for h&#229;nd, det er her datamaskiner kommer p&#229; banen. F&#248;r vi forlater dette delkapitlet, s&#229; har vi en animasjon dere kan utforske for &#229; f&#229; en mer intuitiv forst&#229;else av hva Eulers metode gj&#248;r.

<p>
<iframe scrolling="no" title="Introduksjon Eulers metode" src="https://www.geogebra.org/material/iframe/id/juf4ksht/width/959/height/465/border/888888/sfsb/true/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/false/rc/false/ld/false/sdz/false/ctl/false" width="959px" height="465px" style="border:0px;"> </iframe>

<h1 id="___sec5" class="anchor">Differensiallikninger: Numerisk i python </h1>

<h2 id="___sec6" class="anchor">Eulers metode </h2>
Vi starter med &#229; skrive opp likningen for Eulers metode anvendt p&#229; andre ordens differensiallikninger.

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Eulers metode for andre ordens differensiallikninger er gitt ved
$$
\begin{align*}
y_{i+1} & =y_{i}+y{'}_{i}\cdot h\\
y{'}_{i+1} & =y{'}_{i}+y{''}_{i}\cdot h\\
x_{i+1} & =x_{i}+h
\end{align*}
$$

og to initialverdier: \( (x_{0},y_{0}) \), \( (x_{0},y'_{0}) \)
</div>
<!-- end box -->

N&#229;r vi omformer dette til kode, vil det se slik ut:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>y[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> y[i] <span style="color: #666666">+</span> dy[i]<span style="color: #666666">*</span>h
dy[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> dy[i] <span style="color: #666666">+</span> ddy[i]<span style="color: #666666">*</span>h
x[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> x[i] <span style="color: #666666">+</span> h
</pre></div>
<p>
hvor vi kaller \( y' \) for <code>dy</code> og \( y'' \) for <code>ddy</code>. S&#229; da er sp&#248;rsm&#229;let hvordan vi kan bruke denne metoden i et st&#248;rre program. I forrige delkapittel gjorde vi noen utregninger for h&#229;nd, og der s&#229; vi at vi startet med noen startverdier og brukte dem for &#229; regne oss til neste punkt, og s&#229; neste osv. Det betyr at programmet v&#229;rt trenger f&#248;lgende:

<ul>
<li> Arrays for &#229; lagre verdier av \( x \), \( y' \) og \( y \) alt ettersom vi har en en f&#248;rste eller andre ordens differensiallikning.</li>
<li> Startverdier for \( x \), \( y' \) og \( y \) alt ettersom vi har en en f&#248;rste eller andre ordens differensiallikning.</li>
<li> En for l&#248;kke for &#229; kunne regne ut s&#229; mange punkter p&#229; l&#248;sningsgrafen som vi &#248;nsker.</li>
<li> En steglengde for &#229; bestemme hvor tett punktene skal v&#230;re.</li>
<li> Mulighet for &#229; plotte l&#248;sningen.</li>
</ul>

I tillegg til dette m&#229; vi kunne gj&#248;re om p&#229; differensiallikningene vi l&#248;ser. Differensiallikningen skal alltid st&#229; slik at den mest deriverte \( y \)-en st&#229;r alene p&#229; venstre side i likningen. Vi ser p&#229; noen eksempler i en tabell:

<div class="row">
  <div class="col-xs-8">
    <table class="table table-striped table-hover table-condensed">
<thead>
<tr><td align="left"><b>       Uoppstilt        </b></td> <td align="left"><b>                   Oppstilt                  </b></td> </tr>
</thead>
<tbody>
<tr><td align="left">   \( y'' + 3xy'-e^{x}=0 \)    </td> <td align="left">   \( y'' = - 3xy'+e^{x} \)                         </td> </tr>
<tr><td align="left">   \( y\cdot y' = 5 \)         </td> <td align="left">   \( y' = \frac{5}{y} \)                           </td> </tr>
<tr><td align="left">   3y''+y\cdot y'=5x$          </td> <td align="left">   \( y'' = -\frac{y\cdot y'}{3}+\frac{5x}{2} \)    </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-8 -->
</div> <!-- cell row -->

<h3 id="___sec7" class="anchor">Program for l&#248;sning av f&#248;rste ordens differensiallikning med Eulers metode </h3>

Denne koden skal l&#248;se differensiallikningen
\[
y' - x + 2y = 0,\quad x_{0} = 0, y_{0} = 1
\]
og plotte svaret for \( x \)-verdier frem til 4. <br />
Vi starter med &#229; stille opp likningen:
\[
y' = x - 2y
\]
Deretter skriver vi programmet.
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># -*- coding: utf-8 -*-</span>

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">pylab</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>                 <span style="color: #408080; font-style: italic">#Henter bibliotek for arrays og plotting</span>

<span style="color: #408080; font-style: italic">#Informasjon fra oppgaven</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">dy</span>(x,y):                        <span style="color: #408080; font-style: italic">#Lager en funksjon for difflikning</span>
    <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">-2*</span>y                    <span style="color: #408080; font-style: italic">#Returnerer høyre side i likningen.</span>

x0 <span style="color: #666666">=</span> <span style="color: #666666">0</span>                              <span style="color: #408080; font-style: italic">#Startverdi for x</span>
y0 <span style="color: #666666">=</span> <span style="color: #666666">1</span>                              <span style="color: #408080; font-style: italic">#Startverdi for y</span>
xslutt <span style="color: #666666">=</span> <span style="color: #666666">4</span>                          <span style="color: #408080; font-style: italic">#Sluttverdi for x</span>
N <span style="color: #666666">=</span> <span style="color: #666666">5000</span>                            <span style="color: #408080; font-style: italic">#Hvor mange steg vi tar mellom start/slutt</span>
h <span style="color: #666666">=</span> (xslutt <span style="color: #666666">-</span> x0)<span style="color: #666666">/</span>N                 <span style="color: #408080; font-style: italic">#Kalkulerer steglengden</span>

<span style="color: #408080; font-style: italic">#Gjør klar arrays</span>
x <span style="color: #666666">=</span> zeros(N)                        <span style="color: #408080; font-style: italic">#Gjør klar array for x-verdier</span>
y <span style="color: #666666">=</span> zeros(N)                        <span style="color: #408080; font-style: italic">#Gjør klar array for y-verdier</span>
x[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> x0                           <span style="color: #408080; font-style: italic">#Setter x0 i start av x-verdier</span>
y[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> y0                           <span style="color: #408080; font-style: italic">#Setter y0 i start av y-verdier</span>

<span style="color: #408080; font-style: italic">#Utfører Eulers metode.</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N<span style="color: #666666">-1</span>):
    y[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> y[i] <span style="color: #666666">+</span> dy(x[i],y[i])<span style="color: #666666">*</span>h <span style="color: #408080; font-style: italic">#Kalkulerer den neste y-verdien</span>
    x[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> x[i] <span style="color: #666666">+</span> h               <span style="color: #408080; font-style: italic">#Kalkulerer den neste x-verdien</span>

<span style="color: #408080; font-style: italic">#Plotter løsningsgrafen.</span>
plot(x,y)                           <span style="color: #408080; font-style: italic">#Lager grafen</span>
title(<span style="color: #BA2121">&quot;y&#39; = x - 2y&quot;</span>)                <span style="color: #408080; font-style: italic">#Tittel med difflikningen</span>
xlabel(<span style="color: #BA2121">&quot;x&quot;</span>)                         <span style="color: #408080; font-style: italic">#Navn på x-akse</span>
ylabel(<span style="color: #BA2121">&quot;y&quot;</span>)                         <span style="color: #408080; font-style: italic">#Navn på y-akse</span>
</pre></div>

<h3 id="___sec8" class="anchor">Program for l&#248;sning av andre ordens differensiallikning med Eulers metode </h3>

Vi skal n&#229; l&#248;se differensiallikningen:
\[
y'' -x + 2xy = -3y',\quad x_{0} = 0, y_{0} = 1, y'{}_{0} = 2
\]
og plotte l&#248;sningen for \( x \)-verdier frem til 3. <br />
Vi starter med &#229; stille opp differensiallikningen
\[
y'' = x - 2xy - 3y'
\]
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># -*- coding: utf-8 -*-</span>

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">pylab</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>                 <span style="color: #408080; font-style: italic">#Henter bibliotek for arrays og plotting</span>

<span style="color: #408080; font-style: italic">#Informasjon fra oppgaven</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ddy</span>(x,dy,y):                    <span style="color: #408080; font-style: italic">#Lager en funksjon for difflikning</span>
    <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">-2*</span>x<span style="color: #666666">*</span>y<span style="color: #666666">-3*</span>dy             <span style="color: #408080; font-style: italic">#Returnerer høyre side i likningen.</span>

x0 <span style="color: #666666">=</span> <span style="color: #666666">0</span>                              <span style="color: #408080; font-style: italic">#Startverdi for x</span>
y0 <span style="color: #666666">=</span> <span style="color: #666666">1</span>                              <span style="color: #408080; font-style: italic">#Startverdi for y</span>
dy0 <span style="color: #666666">=</span> <span style="color: #666666">2</span>                             <span style="color: #408080; font-style: italic">#Startverdi for y&#39;</span>
xslutt <span style="color: #666666">=</span> <span style="color: #666666">3</span>                          <span style="color: #408080; font-style: italic">#Sluttverdi for x</span>
N <span style="color: #666666">=</span> <span style="color: #666666">5000</span>                            <span style="color: #408080; font-style: italic">#Hvor mange steg vi tar mellom start/slutt</span>
h <span style="color: #666666">=</span> (xslutt <span style="color: #666666">-</span> x0)<span style="color: #666666">/</span>N                 <span style="color: #408080; font-style: italic">#Kalkulerer steglengden</span>

<span style="color: #408080; font-style: italic">#Gjør klar arrays</span>
x <span style="color: #666666">=</span> zeros(N)                        <span style="color: #408080; font-style: italic">#Gjør klar array for x-verdier</span>
y <span style="color: #666666">=</span> zeros(N)                        <span style="color: #408080; font-style: italic">#Gjør klar array for y-verdier</span>
dy <span style="color: #666666">=</span> zeros(N)
x[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> x0                           <span style="color: #408080; font-style: italic">#Setter x0 i start av x-verdier</span>
y[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> y0                           <span style="color: #408080; font-style: italic">#Setter y0 i start av y-verdier</span>
dy[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> dy0                         <span style="color: #408080; font-style: italic">#Setter dy0 i start av y&#39;-verdier</span>

<span style="color: #408080; font-style: italic">#Utfører Eulers metode.</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N<span style="color: #666666">-1</span>):
    dy[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> dy[i] <span style="color: #666666">+</span> ddy(x[i],dy[i],y[i])<span style="color: #666666">*</span>h  <span style="color: #408080; font-style: italic">#Kalkulerer den neste y&#39;-verdien</span>
    y[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> y[i] <span style="color: #666666">+</span> dy[i]<span style="color: #666666">*</span>h                   <span style="color: #408080; font-style: italic">#Kalkulerer den neste y-verdien</span>
    x[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> x[i] <span style="color: #666666">+</span> h                         <span style="color: #408080; font-style: italic">#Kalkulerer den neste x-verdien</span>

<span style="color: #408080; font-style: italic">#Plotter løsningsgrafen.</span>
plot(x,y)                           <span style="color: #408080; font-style: italic">#Lager grafen</span>
title(<span style="color: #BA2121">&quot;y&#39;&#39; = x - 2xy - 3y&#39;&quot;</span>)        <span style="color: #408080; font-style: italic">#Tittel med difflikningen</span>
xlabel(<span style="color: #BA2121">&quot;x&quot;</span>)                         <span style="color: #408080; font-style: italic">#Navn på x-akse</span>
ylabel(<span style="color: #BA2121">&quot;y&quot;</span>)                         <span style="color: #408080; font-style: italic">#Navn på y-akse</span>
</pre></div>

<h2 id="___sec9" class="anchor">Problemer med Eulers metode </h2>
Det er typisk at n&#229;r man har l&#230;rt en metode s&#229; viser det seg at det finnes bedre metoder. I v&#229;rt tilfelle er Eulers metode egentlig ganske d&#229;rlig. La oss se p&#229; differensiallikningen \( 0.5y''+ 3y = 0 \). Oppstilt er denne likningen: \( y''= -6y \). Vi bruker startverdiene \( x_{0} = 0, y_{0} = -0.04, y'_{0} = 0 \). Dette er en differensiallikning som vi kan regne ut l&#248;sningen av for h&#229;nd. Svaret er funksjonen:
\[
f(x)=-0.04\cdot \cos 2.45x
\]
Vi skal n&#229; skrive et program som plotter l&#248;sningen fra Eulers metode sammen med den korrekte l&#248;sningen over.
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># -*- coding: utf-8 -*-</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">pylab</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>

<span style="color: #408080; font-style: italic">#Informasjon fra oppgaven</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ddy</span>(x,dy,y):
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">-6*</span>y

x0 <span style="color: #666666">=</span> <span style="color: #666666">0</span>
y0 <span style="color: #666666">=</span> <span style="color: #666666">-0.04</span>
dy0 <span style="color: #666666">=</span> <span style="color: #666666">0</span>
xslutt <span style="color: #666666">=</span> <span style="color: #666666">10</span>
N <span style="color: #666666">=</span> <span style="color: #666666">1000</span>
h <span style="color: #666666">=</span> (xslutt <span style="color: #666666">-</span> x0)<span style="color: #666666">/</span>N

<span style="color: #408080; font-style: italic">#Gjør klar arrays</span>
x <span style="color: #666666">=</span> zeros(N)
y <span style="color: #666666">=</span> zeros(N)
dy <span style="color: #666666">=</span> zeros(N)
x[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> x0
y[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> y0
dy[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> dy0

<span style="color: #408080; font-style: italic">#Utfører Eulers metode.</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N<span style="color: #666666">-1</span>):
    dy[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> dy[i] <span style="color: #666666">+</span> ddy(x[i],dy[i],y[i])<span style="color: #666666">*</span>h
    y[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> y[i] <span style="color: #666666">+</span> dy[i]<span style="color: #666666">*</span>h
    x[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> x[i] <span style="color: #666666">+</span> h

<span style="color: #408080; font-style: italic">#Kalkulerer den korrekte løsningen</span>
xkorr <span style="color: #666666">=</span> linspace(x0,xslutt,N)
ykorr <span style="color: #666666">=</span> <span style="color: #666666">-0.04*</span>cos(<span style="color: #666666">2.45*</span>x)

<span style="color: #408080; font-style: italic">#Plotter løsningsgrafen.</span>
plot(x,y)
plot(xkorr,ykorr)
title(<span style="color: #BA2121">&quot;y&#39;&#39; = x - 2xy - 3y&#39;&quot;</span>)
xlabel(<span style="color: #BA2121">&quot;x&quot;</span>)
ylabel(<span style="color: #BA2121">&quot;y&quot;</span>)
legend([<span style="color: #BA2121">&quot;Eulers metode&quot;</span>,<span style="color: #BA2121">&quot;Korrekt løsning&quot;</span>])
</pre></div>
<p>
Kopier denne koden og kj&#248;r den i Spyder. Eksperimenter gjerne med forskjellige verdier for <code>N</code>. Vi ser uansett at linjen som svarer til Eulers metode bommer p&#229; den korrekte l&#248;sningen n&#229;r grafen krummer kraftig. Vi skal derfor se p&#229; andre metoder som er mer egnet. Uansett er Eulers metode et viktig pensum fordi den er den letteste metoden, og en du skal kunne utenat. La oss angripe denne differensiallikningen med noen andre metoder og se om de produserer.

<h2 id="___sec10" class="anchor">Euler-Cromer metoden </h2>
Euler-Cromer metoden er en liten korreksjon av Eulers metode. Den fungerer <b>kun for andre ordens differensiallikninger</b> og har f&#248;lgende likninger.
<div class="alert alert-block alert-success alert-text-normal"><b>Euler-Cromer metoden.</b>
Euler-Cromer metoden for andre ordens differensiallikninger
$$
\begin{align*}
y'_{i+1} & =y'_{i}+y''_{i}\cdot h\\
y_{i+1} & =y_{i}+y'_{i+1}\cdot h\\
x_{i+1} & =x_{i}\cdot h
\end{align*}
$$

<em>NB:</em> Den deriverte m&#229; kalkuleres f&#248;r verdien av \( y \) slik at vi har en verdi for \( y'_{i+1} \) n&#229;r vi kalkulerer \( y_{i+1} \).
</div>

La oss se p&#229; hvordan koden fra forrige delkapittel fungerer med Euler-Cromer metoden.
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># -*- coding: utf-8 -*-</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">pylab</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>

<span style="color: #408080; font-style: italic">#Informasjon fra oppgaven</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ddy</span>(x,dy,y):
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">-6*</span>y

x0 <span style="color: #666666">=</span> <span style="color: #666666">0</span>
y0 <span style="color: #666666">=</span> <span style="color: #666666">-0.04</span>
dy0 <span style="color: #666666">=</span> <span style="color: #666666">0</span>
xslutt <span style="color: #666666">=</span> <span style="color: #666666">10</span>
N <span style="color: #666666">=</span> <span style="color: #666666">2000</span>
h <span style="color: #666666">=</span> (xslutt <span style="color: #666666">-</span> x0)<span style="color: #666666">/</span>N

<span style="color: #408080; font-style: italic">#Gjør klar arrays</span>
x <span style="color: #666666">=</span> zeros(N)
y <span style="color: #666666">=</span> zeros(N)
dy <span style="color: #666666">=</span> zeros(N)
x[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> x0
y[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> y0
dy[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> dy0

<span style="color: #408080; font-style: italic">#Utfører Euler-Cromer metoden.</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N<span style="color: #666666">-1</span>):
    dy[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> dy[i] <span style="color: #666666">+</span> ddy(x[i],dy[i],y[i])<span style="color: #666666">*</span>h
    y[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> y[i] <span style="color: #666666">+</span> dy[i<span style="color: #666666">+1</span>]<span style="color: #666666">*</span>h
    x[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> x[i] <span style="color: #666666">+</span> h

<span style="color: #408080; font-style: italic">#Kalkulerer den korrekte løsningen</span>
xkorr <span style="color: #666666">=</span> linspace(x0,xslutt,N)
ykorr <span style="color: #666666">=</span> <span style="color: #666666">-0.04*</span>cos(<span style="color: #666666">2.45*</span>x)

<span style="color: #408080; font-style: italic">#Plotter løsningsgrafen.</span>
plot(x,y)
plot(xkorr,ykorr)
title(<span style="color: #BA2121">&quot;y&#39;&#39; + 6y = 0&quot;</span>)
xlabel(<span style="color: #BA2121">&quot;x&quot;</span>)
ylabel(<span style="color: #BA2121">&quot;y&quot;</span>)
legend([<span style="color: #BA2121">&quot;Euler-Cromer metoden&quot;</span>,<span style="color: #BA2121">&quot;Korrekt løsning&quot;</span>])
</pre></div>
<p>
Kopier denne koden og kj&#248;r den i Spyder. Som du ser, s&#229; f&#229;r vi en god tilpasning. I koden, g&#229; inn og gj&#248;r om verdien av <code>xslutt = 50</code> og <code>N=500</code>, i dette tilfellet f&#229;r vi en liten forskjell. Du &#248;nsker kanskje &#229; protestere og si at dette er en lav verdi for <code>N</code> n&#229;r vi skal plotte fra 0 til 50, og det er sant. Dette er kun for &#229; vise at selv Euler-Cromer har sine begrensninger, og er uansett bedre enn Eulers metode.

<h1 id="___sec11" class="anchor">Oppgaver </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec12" class="anchor">Exercise 1: Flervalgsquiz </h2>

<p>
Svar p&#229; sp&#248;rsm&#229;lene.
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> Hva er riktig her?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_1_A" style="font-size: 80%;"></a>
<a href="#quiz_id_1_A" data-toggle="collapse">
&nbsp;<b>Choice A:</b>
Euler-Cromer er mindre n&#248;yaktig enn Euler
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_1_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_1_B" style="font-size: 80%;"></a>
<a href="#quiz_id_1_B" data-toggle="collapse">
&nbsp;<b>Choice B:</b>
Euler-Cromer er foretrukken over Euler for andre ordens differensiallikninger.
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_1_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_1_C" style="font-size: 80%;"></a>
<a href="#quiz_id_1_C" data-toggle="collapse">
&nbsp;<b>Choice C:</b>
Euler og Euler-Cromer kan begge brukes p&#229; f&#248;rste ordens differensiallikninger.
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_1_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_1_D" style="font-size: 80%;"></a>
<a href="#quiz_id_1_D" data-toggle="collapse">
&nbsp;<b>Choice D:</b>
Euler-Cromer er den beste metoden for andre ordens differensiallikninger.
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_1_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> Hvordan fungerer Eulers metode?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_2_A" style="font-size: 80%;"></a>
<a href="#quiz_id_2_A" data-toggle="collapse">
&nbsp;<b>Choice A:</b>
Den finner arealet under grafen og lager \( y \)-verdier fra arealet.
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_2_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_2_B" style="font-size: 80%;"></a>
<a href="#quiz_id_2_B" data-toggle="collapse">
&nbsp;<b>Choice B:</b>
Den gj&#248;r et gjennomsnitt av tangenter for &#229; finne det beste stigningstallet og g&#229;r en steglengde frem til neste punkt.
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_2_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_2_C" style="font-size: 80%;"></a>
<a href="#quiz_id_2_C" data-toggle="collapse">
&nbsp;<b>Choice C:</b>
Den regner ut grafen til den deriverte.
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_2_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_2_D" style="font-size: 80%;"></a>
<a href="#quiz_id_2_D" data-toggle="collapse">
&nbsp;<b>Choice D:</b>
Den regner ut stigningen til en tangent og f&#248;lger den en steglengde frem til neste punkt.
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_2_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> I hvilken av alternativene under er difflikningen \( 3xy'+x^{2}y = 5 \) riktig stilt opp?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_3_A" style="font-size: 80%;"></a>
<a href="#quiz_id_3_A" data-toggle="collapse">
&nbsp;<b>Choice A:</b>
\( 3xy' \) = 5-x^{2}y
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_3_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_3_B" style="font-size: 80%;"></a>
<a href="#quiz_id_3_B" data-toggle="collapse">
&nbsp;<b>Choice B:</b>
\( y = \dfrac{5}{x^{2}}-\dfrac{3y'}{x} \)
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_3_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_3_C" style="font-size: 80%;"></a>
<a href="#quiz_id_3_C" data-toggle="collapse">
&nbsp;<b>Choice C:</b>
\( x(3y' + xy) = 5 \)
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_3_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_3_D" style="font-size: 80%;"></a>
<a href="#quiz_id_3_D" data-toggle="collapse">
&nbsp;<b>Choice D:</b>
\( y' = \dfrac{5}{3x}-\dfrac{xy}{3} \)
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_3_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>
<!-- end quiz -->

$$
\begin{align*}
y_{i+1} & =y_{i}+y{'}_{i}\cdot h\\
y{'}_{i+1} & =y{'}_{i}+y{''}_{i}\cdot h\\
x_{i+1} & =x_{i}+h
\end{align*}
$$

<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> Over ser du en kode, hvilken metode er dette?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_4_A" style="font-size: 80%;"></a>
<a href="#quiz_id_4_A" data-toggle="collapse">
&nbsp;<b>Choice A:</b>
Euler-Cromer
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_4_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_4_B" style="font-size: 80%;"></a>
<a href="#quiz_id_4_B" data-toggle="collapse">
&nbsp;<b>Choice B:</b>
Euler
</a>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_4_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec13" class="anchor">Exercise 2: Forst&#229;else av Eulers metode </h2>

<p>
Beskriv med egne ord hva Eulers metode gj&#248;r.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec14" class="anchor">Exercise 3: F&#248;rste ordens differensiallikninger </h2>

<p>
L&#248;s likningene og sammenlikn med den korrekte utregnede l&#248;sningen. Skriv koden fra bunn hver gang. Velg <code>xslutt = 10</code> eller en annen verdi som du mener viser grafen best.

<p>
<b>a)</b>
\[
y'-\dfrac{1}{x}y=\sqrt{x},\quad x_{0} = 1, y_{0} = 4
\]
Korrekt l&#248;sning: \( f(x) = 2x\left(\sqrt{x}+1\right) \)

<p>
<b>b)</b>
\[
y + y' = \sin x,\quad x_{0} = 0, y_{0} = 0
\]
Korrekt l&#248;sning: \( f(x) = \frac{1}{2}(\sin x - \cos x - e^{-x}) \)

<p>
<b>c)</b>
\[
xy' + y = 1,\quad x_{0} = 0.25, y_{0} = 5
\]
Korrekt l&#248;sning: \( f(x) = 1 + \frac{1}{x} \)

<p>
<b>d)</b>
\[
y' = 1,\quad x_{0}= -5, y_{0} = -5
\]
Korrekt l&#248;sning: \( f(x) = x \)

<p>
<b>e)</b>
\[
y' - \cos x =  e^{-x}, \quad x_{0} = 0, y{0} = 0
\]
Korrekt l&#248;sning: \( f(x) = \sin x - e^{-x} + 1 \)

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec15" class="anchor">Exercise 4: Andre ordens differensiallikninger </h2>

<p>
Bruk Euler-Cromer algoritmen til &#229; l&#248;se disse differensiallikningene. Skriv koden fra bunn hver gang.

<p>
<b>a)</b>

<p>
<b>b)</b>

<p>
<b>c)</b>

<p>
<b>d)</b>

<p>
<b>e)</b>

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec16" class="anchor">Exercise 5: Vi omgj&#248;r metodene til funksjoner </h2>

<p>
<b>a)</b>
Skriv et program hvor Eulers metode og Euler-Cromer metoden er funksjoner som l&#248;ser andre ordens differensiallikninger

<p>
<b>b)</b>
Bruk programmet over til &#229; l&#248;se differensiallikningen ... med begge metoder og plott resultatene i samme vindu.

<p>
<b>c)</b>
Bruk programmet i f&#248;rste deloppgave til &#229; plotte forskjellen mellom de to metodene for differensiallikningen

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec17" class="anchor">Exercise 6: 2. ordens Runge Kutta metode (Utfordring) </h2>

<p>
En familie med metoder som ofte brukes i forskning er Runge Kutta metodene og disse finnes i forskjellige varianter. Vi skal i denne oppgaven se p&#229; den som kalles "2. ordens Runge Kutta". F&#248;r du f&#229;r likningene som skal inn i programmet, s&#229; m&#229; vi gj&#248;re om m&#229;ten vi har skrevet ting p&#229;. Vi har sett at f&#248;rste ordens differensiallikninger ser f.eks slik ut: \( y' = 3xy \). I likningene som f&#248;lger, skal vi heller skrive \( y' \) som en funksjon p&#229; denne m&#229;ten: \( y'(x,y) \). Det betyr at i differensiallikningen over er f. eks \( y'(1,2) = 3\cdot 1\cdot 2 = 6 \). Likningene for 2. ordens Runge Kutta er da:
$$
\begin{align*}
k_{1} & =h\cdot y'(x_{i},y_{i})\\
k_{2} & =h\cdot y'\left(x_{i}+\frac{1}{2}h,y_{i}+\frac{1}{2}k_{1}\right)\\
y_{i+1} & =y_{i}+k_{2}\\
x_{i+1} & =x_{i}+h
\end{align*}
$$

hvor \( k_{1} \) og \( k_{2} \) er st&#248;rrelser som regnes ut p&#229; nytt hver gang i l&#248;kken.

<p>
<b>a)</b>
Bruk likningene over til &#229; skrive et program som l&#248;ser differensiallikningen

<p>
<b>b)</b>
Lag et program som inneholder kun <b>&#233;n</b> funksjon som lar brukeren velge hvilken metode (Euler, Euler-Cromer, 2. ordens Runge Kutta) som skal bli brukt til &#229; l&#248;se differensiallikningen.

<p>
<!-- --- end exercise --- -->

<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    
